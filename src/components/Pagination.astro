---
// src/components/Pagination.astro
import Icon from "./Icon.astro";

interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// Генеруємо масив сторінок
const pages = Array.from({ length: totalPages }, (_, i) => i + 1);

const hasPrev = currentPage > 1;
const hasNext = currentPage < totalPages;

// Створюємо базовий URL без параметрів, бо HTMX додасть їх сам через include
const pureBaseUrl = baseUrl.split("?")[0];
---

{
  totalPages > 1 && (
    <nav
      class="pagination"
      aria-label="Pagination"
      hx-include="#filter-form"
      hx-target="#catalog-container"
      hx-swap="innerHTML"
      hx-push-url="true"
    >
      {/*
        hx-target: замінює контент у вказаному селекторі
        hx-select: вибирає тільки потрібну частину з отриманої сторінки
        hx-swap: замінює весь старий контейнер на новий
    */}

      {/* Кнопка "Назад" */}
      <a
        href={hasPrev ? `${pureBaseUrl}?page=${currentPage - 1}` : "#"}
        hx-get={`${pureBaseUrl}?page=${currentPage - 1}`}
        class={`page-control ${!hasPrev ? "disabled" : ""}`}
        aria-disabled={!hasPrev}
      >
        <Icon name="bi:chevron-left" size={24} />
      </a>

      <div class="pages-list">
        {pages.map((page) => (
          <a
            href={`${pureBaseUrl}?page=${page}`}
            hx-get={`${pureBaseUrl}?page=${page}`}
            class={`page-link ${page === currentPage ? "active" : ""}`}
            aria-current={page === currentPage ? "page" : undefined}
          >
            {page}
          </a>
        ))}
      </div>

      {/* Кнопка "Вперед" */}
      <a
        href={hasNext ? `${pureBaseUrl}?page=${currentPage + 1}` : "#"}
        hx-get={`${pureBaseUrl}?page=${currentPage + 1}`}
        class={`page-control ${!hasNext ? "disabled" : ""}`}
        aria-disabled={!hasNext}
      >
        <Icon name="bi:chevron-right" size={24} />
      </a>
    </nav>
  )
}

<style>
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 24px;
    margin-top: 64px;
  }

  .pages-list {
    display: flex;
    gap: 8px;
  }

  .page-link {
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
    text-decoration: none;
    color: var(--main);
    font-size: 16px;
    font-weight: 500;
    transition: all 0.2s ease-in-out;
  }

  .page-link:hover:not(.active) {
    background-color: var(--inputs);
  }

  .page-link.active {
    background-color: var(--button);
    color: white;
  }

  .page-control {
    display: flex;
    align-items: center;
    color: var(--main);
    transition: color 0.2s;
  }

  .page-control:hover:not(.disabled) {
    color: var(--button);
  }

  .page-control.disabled {
    color: var(--gray-light);
    cursor: not-allowed;
    pointer-events: none;
  }
</style>
