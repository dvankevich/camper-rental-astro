---
// src/pages/catalog.astro
import Layout from "../layouts/Layout.astro";
import CamperCard from "../components/CamperCard.astro";
import { fetchCampers } from "../lib/api";

const campers = await fetchCampers({ page: 1, limit: 4 });

// Відладка в терміналі:
console.log("Is array:", Array.isArray(campers));
console.log("Type:", typeof campers);
console.log("Content:", JSON.stringify(campers).slice(0, 100)); // покаже початок даних
---

<Layout title="Catalog">
  <section class="catalog-section">
    <div class="container">
      <div class="list-container">
        {
          /* Додаємо перевірку на існування та тип */
          Array.isArray(campers) && campers.length > 0 ? (
            <ul class="campers-list">
              {campers.map((camper) => (
                <li key={camper.id}>
                  <CamperCard camper={camper} />
                </li>
              ))}
            </ul>
          ) : (
            <p>No campers found or data structure error.</p>
          )
        }
        <button class="load-more">Load more</button>
      </div>
    </div>
  </section>
</Layout>

<style>
  .catalog-section {
    padding: 64px 0;
  }
  .container {
    max-width: 1440px;
    margin: 0 auto;
    padding: 0 64px;
  }
  .campers-list {
    display: flex;
    flex-direction: column;
    gap: 32px;
    margin-bottom: 40px;
  }

  .load-more {
    display: block;
    margin: 0 auto;
    border: 1px solid var(--gray-light);
    background: transparent;
    color: var(--main);
    padding: 16px 32px;
    border-radius: 200px;
    font-weight: 500;
  }
  .load-more:hover {
    border-color: var(--button);
  }
</style>
